import math

import matplotlib as mtp
import matplotlib.pyplot as plt
import numpy as np

colors = {"Xpander-K paths" : "gray",
          "Xpander-All paths" : "green",
            "STRAT-K paths" : "blue",
          "Lower bound": "red",
          "STRAT-All paths" : "red",
          "Jellyfish-All paths": "black",
          "Jellyfish-K paths": "orange",
          }

markers = {"Xpander-All paths" : "o",
             "STRAT-All paths" : "*",
            "Jellyfish-All paths": "d",
           "Xpander-K paths" : "o",
"Lower bound": ">",
           "STRAT-K paths" : "*",
          "Jellyfish-K paths": "d"
          }
def plot_path_lengths(path_lengths, file_name, xTitle, yTitle):
    mtp.rc('font', family='Times New Roman')
    mtp.rcParams['axes.linewidth'] = 1.5  # set the value globally

    plt.figure(figsize=(8, 6))
    for topo_type, data in path_lengths.items():
        num_servers = sorted([float(k) for k in data.keys()])
        path_lengths = [float(data[i]) for i in num_servers]
        if topo_type == "Xpander-K paths" or topo_type == "Jellyfish-K paths" or topo_type == "STRAT-K paths" or topo_type=="Lower bound":
            plt.plot(num_servers, path_lengths, color=colors[topo_type], linestyle='-', marker=markers[topo_type], markersize=12, label=topo_type, linewidth=2.5)
        else:
            plt.plot(num_servers, path_lengths, color=colors[topo_type], linestyle=':', marker=markers[topo_type], label=topo_type, linewidth=2, markersize=12)
    plt.xlabel(xTitle, fontsize=22)
    plt.ylabel(yTitle, fontsize=22)
    plt.legend(loc="best", prop={'size': 18})
    plt.grid(color='k', lw=0.2)
    plt.tick_params(labelsize=18)
    # plt.axhline(lw=1.8)
    # plt.axvline(lw=1.8)
    plt.savefig(file_name)
    plt.close('all')


def plot_path_lengths1(path_lengths, file_name, xTitle, yTitle):
    mtp.rc('font', family='Times New Roman')
    mtp.rcParams['axes.linewidth'] = 1.5  # set the value globally
    # {"STRAT": {"32": "1.51613", "64": "1.76190", "128": "1.88189", "256": "2.16863", "512": "2.57339"},
    #  "Xpander": {"32": "1.51613", "64": "1.77282", "128": "2.01735", "256": "2.33006", "512": "2.60764"},
    #  "Jellyfish": {"32": "1.51613", "64": "1.78282", "128": "2.03076", "256": "2.33946", "512": "2.61312"},
    #  "Lower bound": {"32": "1.51613", "64": "1.76190", "128": "1.88189", "256": "2.05882", "512": "2.53033"}}
    plt.figure(figsize=(8, 6))
    N = 5
    ind = np.arange(N)
    width = 0.1

    lb = [1.51613, 1.76190, 1.88189, 2.05882, 2.53033]
    lb_bar = plt.bar(ind, lb, width, color='red')

    strat = [ 1.51613,1.76190,1.88189, 2.16863, 2.57339]
    strat_bar = plt.bar(ind+width, strat, width, color = 'blue')

    xpander = [ 1.51613, 1.77282, 2.01735, 2.33006, 2.60764]
    xpander_bar = plt.bar(ind+width*2, xpander, width, color='gray')

    jellyfish = [ 1.51613, 1.78282, 2.03076, 2.33946, 2.61312]
    jellyfish_bar = plt.bar(ind+width*3, jellyfish, width, color='orange')

    plt.xticks(ind+width, [32, 64, 128, 256, 512])
    # plt.yticks([1,2,3,4,5])
    plt.xlabel(xTitle, fontsize=22)
    plt.ylabel(r'$\overline{L}_{sp}$', fontsize=22)
    plt.legend((lb_bar, strat_bar, xpander_bar, jellyfish_bar), ("Lower bound", "STRAT", "Xpander", "Jellyfish" ), loc="best", prop={'size': 18})
    plt.grid(color='k', lw=0.2)
    plt.tick_params(labelsize=18)
    # plt.axhline(lw=1.8)
    # plt.axvline(lw=1.8)
    plt.savefig(file_name)
    plt.close('all')

# av 64
p12 = {
'STRAT-All paths':{1.0:2.2023809523809526, 2.0:2.2023809523809526, 3.0:2.2023809523809526, 4.0:2.2023809523809526, 5.0:2.2023809523809526, 10.0:2.2023809523809526},
'Jellyfish-All paths':{1.0:2.292906746031746, 2.0:2.292906746031746, 3.0:2.292906746031746, 4.0:2.292906746031746, 5.0:2.292906746031746, 10.0:2.292906746031746},
'Xpander-All paths':{1.0:2.2212301587301586, 2.0:2.2212301587301586, 3.0:2.2212301587301586, 4.0:2.2212301587301586, 5.0:2.2212301587301586, 10.0:2.2212301587301586},
'STRAT-K paths':{1.0:1.7619047619047619, 2.0:2.0456349206349205, 3.0:2.2023805523809526, 4.0:2.2023805523809526, 5.0:2.2023805523809526, 10.0:2.2023805523809526 },
'Jellyfish-K paths':{1.0:1.814484126984127, 2.0:2.093501984126984, 3.0:2.2757936507936507, 4.0:2.281498015873016, 5.0:2.2817460317460316, 10.0:2.2817460317460316},
'Xpander-K paths':{1.0:1.7728174603174602, 2.0:2.0808531746031744, 3.0:2.2182539682539684, 4.0:2.2199900793650795, 5.0:2.2199900793650795, 10.0:2.2199900793650795}}

plot_path_lengths(p12, 'hnew3', 'K-paths', 'Average Number of Hops')
#
# #th 64
p11 = {
'STRAT-All paths':{1.0:1.0, 2.0:1.0, 3.0:1.0, 4.0:1.0, 5.0:1.0, 10.0:1.0},
'Jellyfish-All paths':{1.0:0.97102241662110508704319300164022, 2.0:0.97102241662110508704319300164022, 3.0:0.97102241662110508704319300164022, 4.0:0.97102241662110508704319300164022, 5.0:0.97102241662110508704319300164022, 10.0:0.97102241662110508704319300164022},
'Xpander-All paths':{1.0:0.99384443200895321222160044767768, 2.0:0.99384443200895321222160044767768, 3.0:0.99384443200895321222160044767768, 4.0:0.99384443200895321222160044767768, 5.0:0.99384443200895321222160044767768, 10.0:0.99384443200895321222160044767768},
'STRAT-K paths':{1.0:0.3217391304347826, 2.0:0.8813233082706766, 3.0:1.0, 4.0:1.0, 5.0:1.0, 10.0:1.0},
'Jellyfish-K paths':{1.0:0.16444444444444445, 2.0:0.8262590594565227, 3.0:0.9692695214105792, 4.0:0.9710224166211038, 5.0:0.9710224166211044, 10.0:0.9710224166211044},
'Xpander-K paths':{1.0:0.26428571428571423, 2.0:0.8808115196524149, 3.0:0.9923858594532701, 4.0:0.9938444320089532, 5.0:0.9938444320089532, 10.0:0.9938444320089532}}

plot_path_lengths(p11, 'hnew2', 'K-paths', 'Normalized Throughput')
#
# #av 265
# p3 = {'STRAT':{1.0:2.21960784313725,3.0:2.32939644607843,5.0:2.3810618872549,10.0:2.3820618872549,20.0:2.38256740196078,30.0:2.38236825980392,40.0:2.38256740196078},
#       'Jellyfish':{1.0:2.33946078431372,3.0:2.44497549019607,5.0:2.49557291666666,10.0:2.5001225490196,20.0:2.49996936274509,30.0:2.50041360294117,40.0:2.50052083333333},
#      'Xpander':{1.0:2.33005514705882,3.0:2.44497549019607,5.0:2.4860294117647,10.0:2.4907781862745,20.0:2.49085477941176,30.0:2.49090073529411,40.0:2.49113051470588}}
#
# plot_path_lengths(p3, 'hnew1', 'K-paths', 'Average Number of Hops')
#
# #th 256
# p4 = {'STRAT':{1.0:0.23972602739726026,2.0:0.7636054398364028,3.0:0.8664458655091469,5.0:0.9246386746203822,10.0:0.9275618374558304,20.0:0.9275618374558304,30.0:0.9275618374558304,40.0:0.9275618374558304},
#       'Jellyfish':{1.0:0.1891891891891892,2.0:0.7330485708058225,3.0:0.8538780992766191,5.0:0.8800419067574647,10.0:0.8800419067574647,20.0:0.8800419067574647,30.0:0.8800419067574647,40.0:0.8800419067574647},
#      'Xpander':{1.0:0.19662921348314608,2.0:0.7329547076860852,3.0:0.8503336425409564,5.0:0.8835943355291705,10.0:0.8835943355291707,20.0:0.8835943355291707,30.0:0.8835943355291707,40.0:0.8835943355291707}}
#
# plot_path_lengths(p4, 'hnew', 'K-paths', 'Normalized Throughput')

#th N

# p1 = {'STRAT':{32.0:1.0, 64.0:1.0, 128.0:0.987719871741068, 256.0:0.92756183745583, 512:0.9879656160824},
#      'Xpander':{32.0:1.0, 64.0:0.993844432008953, 128.0:0.932853570775141, 256.0:0.88359433552917, 512:0.9679656160824},
#      'Jellyfish':{32.0:1.0, 64.0:0.971022416621104, 128.0:0.926693323639888, 256.0:0.880041906757464, 512:0.9649656160824}}
#
# plot_path_lengths(p1, 'h', 'Number of Switches', 'Normalized Throughput')
#
# #th fail 128
# p6 = {'STRAT':{0.0:0.9876012681175899, 2.0:0.9509967793880837, 4.0:0.9185192965597758, 6.0:0.8867334194487012, 8.0:0.853285142880222,10.0:0.818198198198194,12.0:0.7850434052529861,14.0:0.7525954779141748,16.0:0.7201103051050068},
#      'Xpander':{0.0:0.9328535707751416, 2.0:0.9015252640650994, 4.0:0.8725667221034291, 6.0:0.8451480263157894, 8.0:0.8185660874450321,10.0:0.790309432229175,12.0:0.7648941408173314,14.0:0.7396275898242853,16.0:0.7145429285912756},
#      'Jellyfish':{0.0:0.9266933236398887, 2.0:0.8969947153255561, 4.0:0.8687482751823379, 6.0:0.841687141687142, 8.0:0.8157689486080544,10.0:0.7885439340130599,12.0:0.7633762355653835,14.0:0.7390461215932913,16.0:0.7143444444444446}}
#
# plot_path_lengths(p6, 'hnewfail', 'Fail Rate (%)', 'Normalized Throughput')
#
# #av fail 128
# p7 = {'STRAT':{0.0:2.1353961614173227, 2.0:2.1913139763779528, 4.0:2.2014640748031495, 6.0:2.24095718503937, 8.0:2.284325787401575,10.0:2.335199311023622,12.0:2.3687253937007875,14.0:2.4130167322834644,16.0:2.4464812992125986},
#      'Xpander':{0.0:2.333169291338583, 2.0:2.3578371062992125, 4.0:2.3772760826771653, 6.0:2.393270177165354, 8.0:2.4087106299212597,10.0:2.4274114173228347,12.0:2.4438976377952755,14.0:2.459953248031496,16.0:2.477915846456693},
#      'Jellyfish':{0.0:2.3485482283464565, 2.0:2.369279035433071, 4.0:2.385334645669291, 6.0:2.402682086614173, 8.0:2.415661909448819,10.0:2.432332677165354,12.0:2.4475885826771653,14.0:2.460814468503937,16.0:2.4784694881889764}}
#
# plot_path_lengths(p7, 'hnewfail1', 'Fail Rate (%)', 'Average Number of Hops')


x = 122.359375
#
b = 0.71875
a = 0.6562
c = 0.90625
d = 1.28125
e = 1.53125
f = 3.125
#
p12 = {
'STRAT-All paths':{1.0:x, 2.0:x, 3.0:x, 4.0:x, 5.0:x, 10.0:x },

'STRAT-K paths':{1.0: a, 2.0:b, 3.0:c, 4.0:d, 5.0:e, 10.0:f}}
#
plot_path_lengths(p12, 'hnewtime2', 'K-paths', 'Computation Time (s)')
# pp = {"STRAT": {32: 2.00000, 64: 2.00000, 128: 2.00000, 256: 3.00000, 512: 3.00000}, "Xpander": {32: 2.00000, 64: 3.00000, 128: 3.00000, 256: 3.00000, 512: 4.00000}, "Jellyfish": {32: 2.00000, 64: 3.00000, 128: 3.00000, 256: 3.00000, 512: 4.00000}, "Lower bound": {32: 2.00000, 64: 2.00000, 128: 2.00000, 256: 3.00000, 512: 3.00000}}
# plot_path_lengths1(pp, 'dnew', 'Number of Switches', 'D')